# CulturalMacroevolution_Simulation

This repository contains the code and data related to the manuscript Lukas, Towner & Borgerhoff-Mulder "The Potential to Infer the Historical Pattern of Cultural Macroevolution as illustrated by the Western North American Indian Database".

The input data for simulations presented in the manuscript are the phylogeny for the WNAI societies ("WNAI_tree_forsimulation.nex") and the data to identify clades and ecosystems ("WNAI_data_forsimulation.csv"). The phylogeny was derived from the language classification of Ruhlen (1987 Stanford University Press) as modified by Mathew & Pereault (2015 Proceedings B). The classification is provided as a table ("WNAI_languageclassification_labels.csv") and a numerical input ("WNAI_languageclassification_numerical.csv") to illustrate how any hierarchical classification of a set of societies could be converted into a phylogeny using the provided code ("ConvertHierarchyToTree.R"). The phylogeny is also provided as a figure ("Lukas_WNAI_phylogeny.pdf").

The code for for running the simulations in R is presented in two files, one to simulate the evolution of a trait where transitions between all variants are equally likely to occur under a Brownian model of transitions reflecting drift ("SimulateCulturalEvolution_Drift.R") and the evolution of a trait where transitions towards one variant are more likely and transitions from this variant less likely reflecting that this variant would be under selection ("SimulateCulturalEvolution_Drift.R").

The particular output of the simulations we analysed for the manuscript are provided as tables ("CulturalPhylogenetics_SimulationResults_Drift_ForAnalysis.csv" and "CulturalPhylogenetics_SimulationResults_Selection_ForAnalysis.csv"). These can be loaded into R and comparisons of which models fit best for a given simulation can, for example, be assessed using a likelihood ratio test (e.g. for a simulation with four variant 1-pchisq(2*(log likelihood of a reconstruction with a model assuming that some transitions are more likely than others minus log likelihood of a reconstruction with a model assuming that all transitions are equally likely), 11 ) where 11 reflects the degree of freedoms, based on the difference between the 12 different transition rates between all four variants in the free model and the 1 transition rate in the equal rates model. 
